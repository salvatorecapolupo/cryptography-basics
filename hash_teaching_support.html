<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lezione interattiva MD5 e SHA-1</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body { font-family: 'Segoe UI', sans-serif; background: #f0f4f8; }
.container { margin-top: 20px; }
.hash-card { background: #fff; border-radius: 15px; padding: 20px; margin: 20px 0; box-shadow: 0 4px 8px rgba(0,0,0,0.2);}
pre { background: #e0e0e0; padding: 10px; border-radius: 10px; overflow-x: auto; }
h1,h2 { text-align: center; }
.md5 { color: #e67e22; }
.sha1 { color: #3498db; }
.bitop-card { background: #fdf6e3; border-radius: 15px; padding: 15px; margin: 20px 0; }
.md5{color: red;}
.sha{color: green;}
</style>
</head>
<body>

<h1>üîê Lezione Interattiva: MD5 e SHA-1</h1>

<div class="container">

<!-- BLOCCO 1: Form interattivo -->
<div class="hash-card">
<h2>üíª Prova interattiva</h2>
<p>Scrivi una parola o frase e calcola MD5 e SHA-1 reali:</p>
<input type="text" id="inputText" class="form-control mb-3" placeholder="Scrivi qui...">
<button class="btn btn-success" onclick="showHashes()">Calcola hash</button>
<h1 id="hashOutput" class="mt-3 text-start"></h1>
</div>

<!-- BLOCCO 2: Pseudocodice MD5 -->
<div class="hash-card">
<h2 class="md5">MD5 üî∂ Pseudocodice (semplificato)</h2>
<pre>
Input: testo qualsiasi
1. Trasforma il testo in bytes
2. Suddividi i bytes in blocchi di 512 bit
3. Aggiungi padding per completare i blocchi
4. Imposta 4 variabili iniziali (A,B,C,D)
5. Per ogni blocco:
    a. Suddividi in 16 parole da 32 bit
    b. Applica 64 operazioni bit a bit (AND, OR, XOR, NOT, shift rotazionale)
    c. Aggiorna variabili A,B,C,D
6. Combina A,B,C,D in un hash finale di 128 bit
Output: hash esadecimale di 32 caratteri
</pre>
</div>

<!-- BLOCCO 3: Pseudocodice SHA-1 -->
<div class="hash-card">
<h2 class="sha1">SHA-1 üî∑ Pseudocodice semplificato</h2>
<pre>
Input: testo qualsiasi
1. Trasforma il testo in bytes
2. Suddividi in blocchi di 512 bit
3. Applica padding per completare i blocchi
4. Inizializza 5 variabili (H0,H1,H2,H3,H4)
5. Per ogni blocco:
    a. Espandi il blocco in 80 parole da 32 bit
    b. Applica funzioni logiche bit a bit e shift rotazionali
    c. Aggiorna H0,H1,H2,H3,H4
6. Combina le variabili per ottenere hash finale di 160 bit
Output: hash esadecimale di 40 caratteri
</pre>
</div>

<!-- BLOCCO 4: Operazioni bit a bit -->
<div class="bitop-card">
<h2>‚öôÔ∏è Esploriamo le operazioni bit a bit</h2>
<p>Puoi inserire due numeri (0-255) e vedere AND, OR, XOR, shift:</p>
<form onsubmit="return showBitOps()">
<input type="number" id="num1" class="form-control mb-2" placeholder="Numero 1 (0-255)" min="0" max="255">
<input type="number" id="num2" class="form-control mb-2" placeholder="Numero 2 (0-255)" min="0" max="255">
<button class="btn btn-primary mb-2">Calcola Operazioni Bit a Bit</button>
</form>
<div id="bitOpsOutput" class="text-start"></div>
</div>

</div>

<!-- Libreria MD5 -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/blueimp-md5/2.19.0/js/md5.min.js"></script>

<script>
// Funzione interattiva per hash
async function hashString(algorithm, str) {
    const encoder = new TextEncoder();
    const data = encoder.encode(str);
    const hashBuffer = await crypto.subtle.digest(algorithm, data);
    const hashArray = Array.from(new Uint8Array(hashBuffer));
    return hashArray.map(b => b.toString(16).padStart(2,'0')).join('');
}

async function showHashes() {
    const input = document.getElementById('inputText').value;
    if(!input) return;

    // MD5 con libreria
    const md5hash = md5(input);

    // SHA-1 con crypto.subtle
    const sha1hash = await hashString('SHA-1', input);

    document.getElementById('hashOutput').innerHTML = `
        <strong>MD5:</strong> <span class='md5'>${md5hash}</span> <br>
        <strong>SHA-1:</strong> <span class='sha'>${sha1hash}</span>
    `;
}

// BLOCCO operazioni bit a bit
function showBitOps() {
    const n1 = parseInt(document.getElementById('num1').value) || 0;
    const n2 = parseInt(document.getElementById('num2').value) || 0;

    const andResult = n1 & n2;
    const orResult = n1 | n2;
    const xorResult = n1 ^ n2;
    const shiftLeft = n1 << 1;
    const shiftRight = n1 >> 1;

    document.getElementById('bitOpsOutput').innerHTML = `
<b>Numero 1:</b> ${n1} (${n1.toString(2).padStart(8,'0')})<br>
<b>Numero 2:</b> ${n2} (${n2.toString(2).padStart(8,'0')})<br>
<b>AND:</b> ${andResult} (${andResult.toString(2).padStart(8,'0')})<br>
<b>OR:</b> ${orResult} (${orResult.toString(2).padStart(8,'0')})<br>
<b>XOR:</b> ${xorResult} (${xorResult.toString(2).padStart(8,'0')})<br>
<b>Shift Left (n1 &lt;&lt; 1):</b> ${shiftLeft} (${shiftLeft.toString(2).padStart(8,'0')})<br>
<b>Shift Right (n1 &gt;&gt; 1):</b> ${shiftRight} (${shiftRight.toString(2).padStart(8,'0')})
    `;

    return false; // evita submit
}
</script>

</body>
</html>
